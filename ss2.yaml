schemaVersion: '2.0'
product:
  name: CrossAccountAssumeRole
  owner: data-platform-team@yourcompany.com
  description: >
    AWS Service Catalog product that configures cross-account IAM roles
    between an EKS cluster (Account A) and a target account (Account B)
    for controlled S3 access using IRSA or Pod Identity.
  distributor: YourCompany
  supportDescription: >
    Please contact Data Platform team via Slack #aws-support or email
    data-platform-team@yourcompany.com
  supportEmail: data-platform-team@yourcompany.com
  supportUrl: https://yourcompany.atlassian.net/wiki/spaces/AWSServiceCatalog

provisioningArtifacts:
  - name: v1.0.0
    description: Initial release with svc-prefixed roles and PermissionsBoundary enforcement.
    info:
      loadTemplateFromPath: product.yaml
    type: CLOUD_FORMATION_TEMPLATE
    guidance: DEFAULT

tags:
  - Key: Environment
    Value: sandbox
  - Key: Region
    Value: eu-west-1
  - Key: PortfolioType
    Value: localportfolio
  - Key: ManagedBy
    Value: Jenkins
  - Key: Compliance
    Value: true

distributorOptions:
  localPortfolio: true
  targetAccount: "124930443440"
  targetRegion: eu-west-1

provisioningParameters:
  - key: SourceAccountId
    defaultValue: "111111111111"
    description: AWS Account ID where the EKS cluster runs (Account A)
  - key: TargetAccountId
    defaultValue: "124930443440"
    description: AWS Account ID where S3 resources exist (Account B)
  - key: AWSRegion
    defaultValue: "eu-west-1"
    description: Deployment region
  - key: EKSClusterName
    defaultValue: "airflow-eks-cluster"
    description: Name of your EKS cluster
  - key: KubernetesNamespace
    defaultValue: "airflow"
    description: Kubernetes namespace where the service account exists
  - key: ServiceAccountName
    defaultValue: "airflow-worker"
    description: Kubernetes service account name
  - key: RoleAName
    defaultValue: "AirflowPodIdentityRole"
    description: Base name for IAM Role A (svc- prefix is applied automatically)
  - key: RoleBName
    defaultValue: "AirflowCrossAccountTargetRole"
    description: Base name for IAM Role B (svc- prefix is applied automatically)
  - key: PolicyAName
    defaultValue: "AirflowAssumeRoleBPolicy"
  - key: PolicyBName
    defaultValue: "AirflowS3AccessPolicy"
  - key: PermissionsBoundaryArn
    defaultValue: "arn:aws:iam::124930443440:policy/svc-StandardPermissionsBoundary"
    description: >
      Full ARN of the IAM Permissions Boundary policy to attach to created roles.
      Must exist prior to provisioning. Example: arn:aws:iam::124930443440:policy/svc-StandardPermissionsBoundary
  - key: S3BucketPrefix
    defaultValue: "airflow"
  - key: EnableFullS3Access
    defaultValue: "false"
  - key: Environment
    defaultValue: "sandbox"
  - key: ProjectName
    defaultValue: "Airflow-CrossAccount-Access"
  - key: CostCenter
    defaultValue: "DataPlatform"
